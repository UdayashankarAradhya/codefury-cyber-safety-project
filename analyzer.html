<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AI Scam Analyzer - Cyber Shield</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <style>
        html, body {
            height: 100%;
        }

        body {
            font-family: Arial, sans-serif;
            font-size: 18px;
            background-color: #f4f7f6;
            color: #333333;
            display: flex;
            flex-direction: column;
        }

        .content-wrapper {
            flex: 1 0 auto;
        }

        .footer {
            flex-shrink: 0;
        }

        .navbar-dark {
            background-color: #004a7c !important;
        }

        .hero-section {
            background-color: #005b99;
            padding: 4rem 0;
        }

        .card {
            border: 1px solid #dddddd;
            box-shadow: 0 2px 4px rgba(0,0,0,0.05);
            height: 100%;
        }

        .btn-primary {
            background-color: #005b99;
            border-color: #005b99;
        }

        .btn-primary:hover {
            background-color: #004a7c;
            border-color: #004a7c;
        }

        .analysis-result {
            animation: fadeIn 0.5s ease-in;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .risk-high {
            border-left: 5px solid #dc3545;
            background-color: #f8d7da;
        }

        .risk-medium {
            border-left: 5px solid #ffc107;
            background-color: #fff3cd;
        }

        .risk-low {
            border-left: 5px solid #198754;
            background-color: #d1e7dd;
        }
    </style>
</head>
<body>

    <!-- Navigation Bar -->
    <nav class="navbar navbar-dark bg-dark">
        <div class="container-fluid">
            <a class="navbar-brand d-flex align-items-center" href="index.html">
                <!-- SVG Logo -->
                <svg width="30" height="30" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" class="me-2">
                    <path d="M12 2L3 5v6c0 5.55 3.84 10.74 9 12 5.16-1.26 9-6.45 9-12V5L12 2zm0 10.99h7c-.53 4.12-3.28 7.79-7 8.94V13H5V6.3l7-3.11v9.8z" fill="#0d6efd"/>
                </svg>
                Cyber Shield
            </a>
            <div class="d-flex">
                <a href="index.html" class="btn btn-outline-light me-2">Home</a>
                <a href="learn.html" class="btn btn-outline-light me-2">Learn</a>
                <a href="stories.html" class="btn btn-outline-light me-2">Stories</a>
                <a href="simulator.html" class="btn btn-outline-light me-2">Simulator</a>
                <a href="analyzer.html" class="btn btn-light">AI Analyzer</a>
            </div>
        </div>
    </nav>

    <!-- Main Content Wrapper -->
    <main class="content-wrapper">
        <div class="container my-5">
            <div class="col-lg-8 mx-auto">
                <h1 class="text-center">AI Scam Analyzer</h1>
                <p class="lead text-center">Received a suspicious message? Paste it below and our AI will check it for you.</p>
                
                <div class="card mt-4">
                    <div class="card-body">
                        <div class="form-group">
                            <label for="messageInput">Paste your message here:</label>
                            <textarea class="form-control" id="messageInput" rows="5" placeholder="e.g., Congratulations! You've won a free prize..."></textarea>
                        </div>
                        <button id="analyzeBtn" class="btn btn-primary mt-3 w-100">Analyze Message</button>
                    </div>
                </div>

                <!-- Loading Spinner -->
                <div id="loader" class="text-center my-4" style="display: none;">
                    <div class="spinner-border" role="status">
                        <span class="visually-hidden">Loading...</span>
                    </div>
                    <p>Analyzing message patterns...</p>
                </div>

                <!-- AI Result Area -->
                <div id="result" class="mt-4"></div>
            </div>
        </div>
    </main>

    <!-- Footer -->
    <footer class="footer bg-dark text-white text-center py-3">
        <div class="container">
            <!-- Emergency Contact Information -->
            <div class="card my-4 bg-danger text-white">
                <div class="card-body text-center">
                    <h3>If You've Been Scammed</h3>
                    <p><strong>Report immediately to:</strong></p>
                    <div class="row">
                        <div class="col-md-4">
                            <h5>Cyber Crime Helpline</h5>
                            <p><strong>1930</strong></p>
                        </div>
                        <div class="col-md-4">
                            <h5>National Cyber Crime Portal</h5>
                            <p><strong><a href="https://cybercrime.gov.in" target="_blank" class="text-white text-decoration-underline">cybercrime.gov.in</a></strong></p>
                        </div>
                        <div class="col-md-4">
                            <h5>Your Bank's Helpline</h5>
                            <p><strong>Immediately block cards/accounts</strong></p>
                        </div>
                    </div>
                </div>
            </div>
            <p class="mb-0">&copy; 2025 Cyber Shield. A CodeFury 8.0 Project.</p>
        </div>
    </footer>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
    <script>
        const analyzeBtn = document.getElementById('analyzeBtn');
        const messageInput = document.getElementById('messageInput');
        const resultDiv = document.getElementById('result');
        const loader = document.getElementById('loader');

        // Improved scam detection patterns
        const scamPatterns = {
            high: [
                // Prize/lottery scams
                { pattern: /(congratulations|congrats).*(won|win|winner|prize)/i, description: "Fake prize/lottery claims" },
                { pattern: /(you.*won|you've.*won|you.*win|you've.*one).*(money|prize|cash|amount)/i, description: "Fake prize/lottery claims" },
                { pattern: /won.*(unlimited|crore|lakh|dollar|rupee)/i, description: "Fake prize/lottery claims" },
                
                // Urgent action with links
                { pattern: /click.*(link|here|now)/i, description: "Suspicious link requests" },
                { pattern: /(urgent|immediate|asap).*(click|link|action)/i, description: "Urgent action requests with suspicious links" },
                
                // Account threats
                { pattern: /(verify|update).*(account|profile).*(suspend|block|deactivate)/i, description: "Account suspension threats" },
                { pattern: /(account|card).*(blocked|suspended|frozen|expire)/i, description: "Fake account security alerts" },
                
                // Money requests
                { pattern: /(send|transfer|pay).*(money|amount|rupee|cash).*(urgent|immediate|asap)/i, description: "Urgent money requests" },
                { pattern: /(deposit|payment).*(required|needed|mandatory)/i, description: "Fake payment requests" },
                
                // OTP/security
                { pattern: /(otp|pin|password|cvv).*(share|send|provide|give)/i, description: "OTP/credential sharing requests" },
                { pattern: /share.*(otp|pin|password|code)/i, description: "OTP/credential sharing requests" },
                
                // Bank/financial scams
                { pattern: /(bank|atm|card).*(block|suspend|deactivate).*(reactivate|unblock)/i, description: "Fake bank security alerts" },
                { pattern: /(kyc|know your customer).*(update|expire|pending)/i, description: "Fake KYC update requests" },
                
                // Investment/job scams
                { pattern: /(easy.*money|part.*time|work.*home).*(earn|income|salary)/i, description: "Too-good-to-be-true job offers" },
                { pattern: /(investment|invest).*(guarantee|assured|risk.*free).*(return|profit)/i, description: "Investment scam promises" },
                
                // Pressure tactics
                { pattern: /(limited.*time|offer.*expire|act.*now|today.*only)/i, description: "Pressure tactics with time limits" },
                { pattern: /(last.*chance|final.*notice|expire.*today)/i, description: "Pressure tactics with time limits" }
            ],
            medium: [
                { pattern: /free.*(gift|offer|trial)/i, description: "Free gift/offer claims" },
                { pattern: /(update|renew).*(kyc|profile|details)/i, description: "Update requests" },
                { pattern: /(call|contact).*(number|immediately|urgent)/i, description: "Urgent contact requests" },
                { pattern: /download.*(app|software|file)/i, description: "App/software download requests" },
                { pattern: /(service|subscription|plan).*(expire|end|renew)/i, description: "Service expiration claims" },
                { pattern: /(confirm|verify).*(identity|details|information)/i, description: "Identity verification requests" }
            ],
            low: [
                { pattern: /(discount|sale|offer).*(shop|store|product)/i, description: "Regular promotional content" },
                { pattern: /(newsletter|updates|notification)/i, description: "Newsletter communications" },
                { pattern: /(delivery|shipment|order).*(status|update)/i, description: "Legitimate delivery updates" }
            ]
        };

        const legitimatePatterns = [
            /official.*(government|bank|company).*website/i,
            /unsubscribe.*(here|link)/i,
            /(customer.*service|support.*team).*(legitimate|known).*(company|brand)/i,
            /https:\/\/[a-z0-9.-]+\.(gov|edu|org)\b/i
        ];

        analyzeBtn.addEventListener('click', analyzeMessage);

        function analyzeMessage() {
            const messageText = messageInput.value.trim();
            if (!messageText) {
                // Replaced alert with a Bootstrap modal or an inline message for a better user experience.
                displayModal('Input Required', 'Please enter a message to analyze.');
                return;
            }

            loader.style.display = 'block';
            resultDiv.innerHTML = '';
            analyzeBtn.disabled = true;

            // Simulate AI processing delay
            setTimeout(() => {
                const analysis = performScamAnalysis(messageText);
                displayResults(analysis);
                loader.style.display = 'none';
                analyzeBtn.disabled = false;
            }, 2000);
        }

        function performScamAnalysis(message) {
            const foundPatterns = [];
            let score = 0;

            // Check for high-risk patterns
            scamPatterns.high.forEach(item => {
                if (item.pattern.test(message)) {
                    foundPatterns.push({ ...item, risk: 'high' });
                    score += 4; // Increased weight for high-risk patterns
                }
            });

            // Check for medium-risk patterns
            scamPatterns.medium.forEach(item => {
                if (item.pattern.test(message)) {
                    foundPatterns.push({ ...item, risk: 'medium' });
                    score += 2;
                }
            });

            // Check for low-risk patterns
            scamPatterns.low.forEach(item => {
                if (item.pattern.test(message)) {
                    foundPatterns.push({ ...item, risk: 'low' });
                    score += 1;
                }
            });

            // Additional suspicious indicators
            const hasPhoneNumber = /\d{10}|\+\d{11,}/.test(message);
            const hasSuspiciousUrl = /[a-z]+\.[a-z]{2,}(?!\s|$)/.test(message) && !/https:\/\//.test(message);
            const hasUrgentLanguage = /urgent|immediate|expire|suspend|block|asap|now|today/i.test(message);
            const hasPoorGrammar = /you've.*one\b|recieved|loose|there\s+account|your\s+account\s+are/i.test(message);
            const hasMoneyMention = /money|cash|amount|rupee|dollar|crore|lakh|prize|reward/i.test(message);
            const hasClickRequest = /click|tap|press|select/i.test(message);

            // Add bonus scores for combinations of suspicious elements
            if (hasMoneyMention && hasClickRequest) score += 3; // Money + click = very suspicious
            if (hasUrgentLanguage && hasClickRequest) score += 2; // Urgent + click = suspicious
            if (hasPoorGrammar && hasMoneyMention) score += 2; // Grammar + money = suspicious
            if (hasPhoneNumber && hasUrgentLanguage) score += 2; // Phone + urgent = suspicious
            if (hasSuspiciousUrl) score += 2; // Suspicious URL

            // Check for legitimate indicators
            const hasLegitimateMarkers = legitimatePatterns.some(pattern => pattern.test(message));
            if (hasLegitimateMarkers) {
                score = Math.max(0, score - 3);
            }

            // Determine overall risk level with improved thresholds
            let riskLevel = 'low';
            if (score >= 6) {
                riskLevel = 'high';
            } else if (score >= 3) {
                riskLevel = 'medium';
            }

            return {
                riskLevel,
                score,
                foundPatterns,
                hasPhoneNumber,
                hasSuspiciousUrl,
                hasUrgentLanguage,
                hasPoorGrammar,
                hasMoneyMention,
                hasClickRequest,
                hasLegitimateMarkers
            };
        }

        function displayResults(analysis) {
            const { riskLevel, foundPatterns, hasPhoneNumber, hasSuspiciousUrl, hasUrgentLanguage, hasPoorGrammar, hasMoneyMention, hasClickRequest, score } = analysis;
            
            let verdict, verdictClass, recommendations;

            switch (riskLevel) {
                case 'high':
                    verdict = "HIGH RISK - Likely a Scam";
                    verdictClass = "risk-high";
                    recommendations = [
                        "DO NOT click any links or download attachments",
                        "DO NOT share personal information, OTPs, or passwords",
                        "DO NOT send money or make any payments",
                        "Block the sender and delete the message immediately",
                        "If money was involved, report to cybercrime.gov.in and call 1930",
                        "Contact your bank if you shared any financial details"
                    ];
                    break;
                case 'medium':
                    verdict = "MEDIUM RISK - Be Very Cautious";
                    verdictClass = "risk-medium";
                    recommendations = [
                        "Verify independently through official channels only",
                        "Don't trust the message at face value",
                        "Be cautious of any requests for personal information",
                        "When in doubt, ask someone you trust",
                        "Don't feel pressured to act immediately"
                    ];
                    break;
                default:
                    verdict = "LOW RISK - Appears Safe";
                    verdictClass = "risk-low";
                    recommendations = [
                        "Message appears to be legitimate",
                        "Still verify through official channels if unsure",
                        "Trust your instincts if something feels off",
                        "Stay educated about new scam patterns"
                    ];
            }

            let redFlags = [];
            foundPatterns.forEach(pattern => {
                redFlags.push(`${pattern.description} detected`);
            });

            // Add specific red flags for the additional checks
            if (hasPhoneNumber) redFlags.push("Contains phone number (verify authenticity)");
            if (hasSuspiciousUrl) redFlags.push("Contains suspicious or unencrypted URL");
            if (hasUrgentLanguage) redFlags.push("Uses urgent/pressure language");
            if (hasPoorGrammar && riskLevel !== 'low') redFlags.push("Contains grammar/spelling errors typical of scams");
            if (hasMoneyMention && hasClickRequest) redFlags.push("Combines money offers with click requests (major red flag)");

            const resultHTML = `
                <div class="card analysis-result ${verdictClass}">
                    <div class="card-body">
                        <h3>${verdict}</h3>
                        <p><small>Risk Score: ${score}/10+</small></p>
                        
                        ${redFlags.length > 0 ? `
                            <h5 class="mt-3">Warning Signs Detected:</h5>
                            <ul>
                                ${redFlags.map(flag => `<li>${flag}</li>`).join('')}
                            </ul>
                        ` : '<p class="mt-3">No major warning signs detected.</p>'}
                        
                        <h5 class="mt-3">What You Should Do:</h5>
                        <ul>
                            ${recommendations.map(rec => `<li>${rec}</li>`).join('')}
                        </ul>
                        
                        ${riskLevel === 'high' ? `
                            <div class="alert alert-danger mt-3">
                                <strong>URGENT:</strong> This message shows multiple signs of being a scam. Do not interact with it in any way. Scammers often target people with fake prize/money offers to steal personal information or money.
                            </div>
                        ` : `
                            <div class="alert alert-info mt-3">
                                <strong>Remember:</strong> Legitimate companies and banks will never ask for sensitive information via SMS or WhatsApp. When in doubt, always verify through official channels.
                            </div>
                        `}
                    </div>
                </div>
            `;

            resultDiv.innerHTML = resultHTML;
        }

        // Function to display a Bootstrap modal
        function displayModal(title, message) {
            // Check if a modal already exists and remove it
            const existingModal = document.getElementById('alertModal');
            if (existingModal) {
                existingModal.remove();
            }

            const modalHTML = `
                <div class="modal fade" id="alertModal" tabindex="-1" aria-labelledby="alertModalLabel" aria-hidden="true">
                  <div class="modal-dialog">
                    <div class="modal-content">
                      <div class="modal-header">
                        <h5 class="modal-title" id="alertModalLabel">${title}</h5>
                        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                      </div>
                      <div class="modal-body">
                        ${message}
                      </div>
                      <div class="modal-footer">
                        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
                      </div>
                    </div>
                  </div>
                </div>
            `;
            document.body.insertAdjacentHTML('beforeend', modalHTML);
            const alertModal = new bootstrap.Modal(document.getElementById('alertModal'));
            alertModal.show();
        }
    </script>
</body>
</html>
