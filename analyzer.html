<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>AI Scam Analyzer - Cyber Shield</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">

  <style>
    :root{
      --accent:#0d6efd;
      --glass: rgba(255,255,255,0.04);
      --card-radius:16px;
      --text-light: #e9eef8;
    }
    html,body{height:100%; margin:0; font-family: Inter, system-ui, Arial; background:
      radial-gradient(800px 400px at 10% 10%, rgba(13,110,253,0.08), transparent 10%),
      radial-gradient(600px 300px at 90% 80%, rgba(255,183,3,0.05), transparent 12%),
      linear-gradient(180deg,#071025 0%, #061223 55%, #071229 100%);
      color:var(--text-light); -webkit-font-smoothing:antialiased;}

    /* Ensure every piece of text inside the analyzer is light */
    /* Using strong selectors and !important to override Bootstrap defaults */
    body, body * { color: var(--text-light) !important; }
    a, a:hover, a:focus { color: #bfe3ff !important; text-decoration: none !important; }

    .blob{position:absolute;border-radius:50%;filter:blur(36px);opacity:.35;mix-blend-mode:screen;pointer-events:none;z-index:0;animation:float 12s ease-in-out infinite;}
    .blob.b1{width:420px;height:420px;left:-90px;top:-60px;background:linear-gradient(135deg,#0d6efd,#7c8cff);}
    .blob.b2{width:320px;height:320px;right:-60px;top:40px;background:linear-gradient(135deg,#ffb703,#ff7a59);animation-duration:15s;}
    @keyframes float{0%{transform:translateY(0)}50%{transform:translateY(-30px)}100%{transform:translateY(0)}}

    /* navbar */
    .navbar{background:linear-gradient(90deg, rgba(255,255,255,0.03), rgba(255,255,255,0.01)); border-radius:12px; margin:18px; padding:.5rem 1rem; box-shadow:0 10px 30px rgba(0,0,0,0.45); z-index:5;}
    .navbar-brand{font-weight:700;color:var(--accent); display:flex; gap:.6rem; align-items:center;}

    main{position:relative; z-index:5; padding-bottom:48px;}
    .hero-card{max-width:960px;margin:48px auto;padding:28px;border-radius:18px;background:linear-gradient(180deg, rgba(255,255,255,0.03), rgba(255,255,255,0.02));border:1px solid rgba(255,255,255,0.06); box-shadow:0 10px 36px rgba(0,0,0,0.6);}

    /* Make form controls dark background + light text */
    textarea.form-control, input.form-control {
      background: rgba(255,255,255,0.02) !important;
      color: var(--text-light) !important;
      border-radius:12px;
      border:1px solid rgba(255,255,255,0.06) !important;
    }
    textarea::placeholder { color: rgba(233,238,248,0.45) !important; }

    .btn-primary{background:linear-gradient(90deg,var(--accent),#5aa0ff); border-radius:12px; border:none; font-weight:600;}
    .sample-btn{border-radius:999px; padding:.35rem .7rem; font-size:.85rem;}

    .analysis-result{
      margin-top:20px;
      border-radius:12px;
      padding:18px;
      border:1px solid rgba(255,255,255,0.04);
      background:linear-gradient(180deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01));
      color: var(--text-light) !important;
    }
    /* Force all children inside analysis-result to be light */
    .analysis-result, .analysis-result * { color: var(--text-light) !important; }

    .flag{display:inline-flex; align-items:center; gap:.6rem; padding:.45rem .6rem; border-radius:12px; font-weight:600;}
    .flag.high{background:rgba(220,53,69,0.12); color:#ffcfcf; border-left:4px solid #dc3545;}
    .flag.medium{background:rgba(255,193,7,0.08); color:#fff6d6; border-left:4px solid #ffc107;}
    .flag.low{background:rgba(25,135,84,0.08); color:#dff6ea; border-left:4px solid #198754;}

    .icon-circle{width:44px;height:44px;border-radius:10px;display:inline-flex;align-items:center;justify-content:center;background:rgba(255,255,255,0.02);box-shadow:inset 0 -6px 14px rgba(0,0,0,0.3);}

    .helpers {display:flex; gap:10px; flex-wrap:wrap; margin-top:12px;}
    .sample-list button{margin-right:8px; margin-bottom:8px;}

    /* Bootstrap alerts override to appear correctly on dark background */
    .alert { background: rgba(255,255,255,0.02) !important; border: 1px solid rgba(255,255,255,0.04) !important; color: var(--text-light) !important; }

    /* small helper texts */
    .lead, .form-label, small, .meta { color: rgba(233,238,248,0.85) !important; }

    @media(max-width:767px){ .hero-card{padding:18px;} }
  </style>
</head>
<body>

  <div class="blob b1" aria-hidden="true"></div>
  <div class="blob b2" aria-hidden="true"></div>

  <nav class="navbar navbar-expand-lg navbar-dark">
    <div class="container-fluid">
      <a class="navbar-brand" href="index.html">
        <svg width="36" height="36" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" style="border-radius:8px;">
          <defs><linearGradient id="g1" x1="0" x2="1"><stop offset="0" stop-color="#0d6efd"/><stop offset="1" stop-color="#7c8cff"/></linearGradient></defs>
          <path d="M12 2L3 5v6c0 5.55 3.84 10.74 9 12 5.16-1.26 9-6.45 9-12V5L12 2z" fill="url(#g1)"/>
        </svg>
        <span>Cyber Shield</span>
      </a>

      <div class="d-flex">
        <a href="index.html" class="btn btn-outline-light me-2">Home</a>
        <a href="learn.html" class="btn btn-outline-light me-2">Learn</a>
        <a href="stories.html" class="btn btn-outline-light me-2">Stories</a>
        <a href="simulator.html" class="btn btn-outline-light me-2">Simulator</a>
        <a href="analyzer.html" class="btn btn-light">ðŸŒŸ AI Analyzer</a>
      </div>
    </div>
  </nav>

  <main>
    <div class="hero-card text-white">
      <div class="d-flex gap-3 flex-wrap">
        <div style="flex:1;">
          <h1 style="margin:0 0 .4rem 0;">AI Scam Analyzer</h1>
          <p class="lead" style="color:rgba(233,238,248,0.85);">Paste a suspicious message and get a quick risk reading. Includes helpful actions and sample msgs to test.</p>

          <div class="card" style="background:transparent; border:none; box-shadow:none; padding:0;">
            <div class="card-body p-0">
              <label for="messageInput" class="form-label">Paste your message</label>
              <textarea id="messageInput" rows="5" class="form-control" placeholder="e.g., Congratulations! You've won a free prize..."></textarea>

              <div class="helpers mt-3">
                <div class="sample-list">
                  <!-- sample message quick-fill buttons -->
                  <button class="btn btn-outline-light sample-btn" onclick="fillSample('Congratulations! You have won a prize. Click here to claim: free-prize.xyz')">Prize scam</button>
                  <button class="btn btn-outline-light sample-btn" onclick="fillSample('Your account will be suspended unless you verify now: fake-bank-verify.com')">Bank alert</button>
                  <button class="btn btn-outline-light sample-btn" onclick="fillSample('We need OTP to process refund, share your OTP to confirm')">OTP request</button>
                </div>
                <div style="margin-left:auto; display:flex; gap:8px;">
                  <button id="analyzeBtn" class="btn btn-primary">Analyze Message</button>
                  <button id="clearBtn" class="btn btn-outline-light" onclick="document.getElementById('messageInput').value=''">Clear</button>
                </div>
              </div>

              <div id="loader" class="text-center mt-3" style="display:none;">
                <div class="spinner-border" role="status"><span class="visually-hidden">Loading...</span></div>
                <div style="margin-top:8px;color:rgba(233,238,248,0.7)">Analyzing patterns...</div>
              </div>

              <div id="result" class="mt-3"></div>
            </div>
          </div>
        </div>

        <!-- right-side quick tips -->
        <div style="width:240px;">
          <div style="border-radius:12px;padding:14px;border:1px solid rgba(255,255,255,0.04);background:linear-gradient(180deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01));">
            <div style="display:flex; gap:10px; align-items:center;">
              <div class="icon-circle">
                <!-- info icon -->
                <svg width="20" height="20" viewBox="0 0 24 24" fill="none"><path d="M12 2a10 10 0 100 20 10 10 0 000-20zM11 10h2v6h-2v-6zm0-4h2v2h-2V6z" fill="#fff"/></svg>
              </div>
              <div>
                <h6 style="margin:0">Quick tips</h6>
                <small style="color:rgba(233,238,248,0.75)">Don't click links. Never share OTPs. Verify independently.</small>
              </div>
            </div>

            <hr style="border-color:rgba(255,255,255,0.04); margin:12px 0;">
            <div>
              <small style="color:rgba(233,238,248,0.75)">Examples:</small>
              <ul style="padding-left:18px;margin-top:6px;color:rgba(233,238,248,0.8);">
                <li>Fake prize / lottery wins</li>
                <li>Account verification requests with links</li>
                <li>OTP sharing or payment requests</li>
              </ul>
            </div>
          </div>
        </div>

      </div>
    </div>
  </main>

  <footer style="position:relative; z-index:5; text-align:center; color:rgba(233,238,248,0.75); margin-top:20px;">
    <p class="mb-0">&copy; 2025 Cyber Shield</p>
  </footer>

  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
  <script>
    const analyzeBtn = document.getElementById('analyzeBtn');
    const messageInput = document.getElementById('messageInput');
    const resultDiv = document.getElementById('result');
    const loader = document.getElementById('loader');

    analyzeBtn.addEventListener('click', analyzeMessage);

    function fillSample(text){ messageInput.value = text; }

    function analyzeMessage() {
      const text = messageInput.value.trim();
      if(!text){ showInlineAlert('Please paste a message to analyze'); return; }
      loader.style.display = 'block'; resultDiv.innerHTML = '';
      analyzeBtn.disabled = true;

      setTimeout(()=>{
        const analysis = performScamAnalysis(text);
        showResult(analysis);
        loader.style.display='none'; analyzeBtn.disabled=false;
      }, 900);
    }

    /* UPDATED pattern detection logic */
    function performScamAnalysis(message){
      const flags = [];
      let score = 0;
      const lower = message.toLowerCase();

      // Updated rules with better scoring
      if(/otp|pin|password|cvv|share(.*)otp/.test(lower)){ flags.push('Asks for OTP/credentials'); score+=6; }
      if(/congrat|won|prize|reward/.test(lower)){ flags.push('Prize/lottery language'); score+=3; }
      if(/click.*(link|here)|https?:\/\/|\.xyz|\.net|\.com/.test(lower)){ flags.push('External link / domain'); score+=3; }
      if(/urgent|immediate|asap|expire|suspend|blocked/.test(lower)){ flags.push('Urgent / pressure language'); score+=2; }
      if(/\d{10,}|pay.*\d+/.test(lower)){ flags.push('Phone number or payment request present'); score+=2; }

      // Updated risk thresholds
      let risk = 'Low';
      if(score >= 5) risk = 'High';
      else if(score >= 3) risk = 'Medium';

      return { risk, score, flags };
    }

    function showResult(a){
      const riskBadge = a.risk === 'High' ? '<span class="flag high">HIGH RISK</span>' : a.risk === 'Medium' ? '<span class="flag medium">MEDIUM RISK</span>' : '<span class="flag low">LOW RISK</span>';
      const flagsHTML = a.flags.length ? `<h6 class="mt-3">Red flags</h6><ul>${a.flags.map(f=>`<li>${f}</li>`).join('')}</ul>` : '<p>No clear red flags detected.</p>';
      const recommendations = a.risk === 'High' ? ['Do not click links', 'Do not share OTP/password', 'Block sender & report'] : ['Verify via official channels', 'Avoid clicking links', 'When in doubt, ask someone trusted'];

      resultDiv.innerHTML = `
        <div class="analysis-result">
          <div class="d-flex justify-content-between align-items-center">
            <div>${riskBadge} <small style="color:rgba(233,238,248,0.7); margin-left:8px;">Score: ${a.score}</small></div>
            <div>
              <button class="btn btn-sm btn-outline-light" onclick="copyText()">Copy Message</button>
              <button class="btn btn-sm btn-primary" onclick="reportSample()">Report</button>
            </div>
          </div>
          ${flagsHTML}
          <h6 class="mt-2">What to do</h6>
          <ul>${recommendations.map(r=>`<li>${r}</li>`).join('')}</ul>
        </div>
      `;
    }

    function showInlineAlert(text){
      resultDiv.innerHTML = `<div class="alert alert-warning">${text}</div>`;
      setTimeout(()=>{ resultDiv.innerHTML = ''; }, 2000);
    }

    function copyText(){
      // Using document.execCommand for broader compatibility in iFrames
      const el = document.createElement('textarea');
      el.value = messageInput.value;
      document.body.appendChild(el);
      el.select();
      try {
        document.execCommand('copy');
        showInlineAlert('Message copied to clipboard');
      } catch (err) {
        showInlineAlert('Copy failed');
      }
      document.body.removeChild(el);
    }
    function reportSample(){ 
        showInlineAlert('Redirecting to National Cyber Crime Portal...');
        setTimeout(() => {
            window.open('https://cybercrime.gov.in', '_blank');
        }, 1500);
    }
  </script>
</body>
</html>
